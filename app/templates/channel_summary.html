<tr name="summary-parent">
    <td class="text-center" rowspan="{{ channel.num_testpoints() + 1 }}">
        <table class="table table-bordered table-secondary">
            <tbody>
                <tr>
                    <td class="text-center align-middle table-primary">Test Equipment</td>
                    <td class="text-center">
                    {# Iterate through each of the Required TestEquipment for the channel and add a button for each #}
                    {% for test_equipment_type in channel.required_test_equipment.all() %}
                        {% set equipment_id = "equipment-{}".format(test_equipment_type.id) %}
                        <div class="row">
                            <div class="col-12 g-1">
                                <div class="btn-group" role="group">
                                    {% set equip_id = "equip-{}-{}".format(test_equipment_type.id, channel.id) %}   
                                    {% set current_test_equipment = channel.current_test_equipment(test_equipment_type.id) %}
                                    {# Create the button and populate the text with the name and asset_id of the currently assigned TestEquipment #}
                                    {% if current_test_equipment == None %}                     
                                        <button id="{{ equip_id }}" name="equipment-button" type="button" class="btn btn-outline-primary dropdown-toggle badge" data-toggle="dropdown" data-equipment-type-id="{{ test_equipment_type.id }}">
                                            {{ test_equipment_type.name }} 
                                            (<span name="asset-id">None</span>)
                                        </button>
                                    {% else %}
                                        <button id="{{ equip_id }}" name="equipment-button" type="button" class="btn btn-primary dropdown-toggle badge" data-toggle="dropdown" data-equipment-type-id="{{ test_equipment_type.id }}">
                                            {{ test_equipment_type.name }} 
                                            (<span name="asset-id">{{ current_test_equipment.asset_id }}</span>)
                                        </button>
                                    {% endif %}
                                    <ul class="dropdown-menu dropdown-menu-end">
                                        {# Create additional dropdown list items for each TestEquipment item assigned to the Project for the specific TestEquipmentType #}
                                        {% for test_equipment in group.job.project.test_equipment.filter_by(name=test_equipment_type.name).all() %}
                                            <li name="equipment-choice" data-equipment-id="{{ test_equipment.id }}">
                                                <a class="dropdown-item" href="javascript:void(0);">
                                                    <span name="asset-id">{{ test_equipment.asset_id }}</span>: Due {{ moment(test_equipment.due_date()).format("DD-MMM-YYYY") }}
                                                </a>
                                            </li>
                                        {% endfor %}
                                    </ul>
                                </div>
                            </div>
                        </div>                                               
                    {% endfor %}
                    </td>
                </tr>
                <tr>
                    <td class="text-center align-middle table-primary">Interface</td>
                    <td class="text-center align-middle">
                        {% if channel.interface == None %}            
                            {{ channel_form.interface(value="") }}
                        {% else %}
                            {{ channel_form.interface(value=channel.interface) }}
                        {% endif %}
                    </td>
                </tr>
                <tr>
                    <td class="text-center align-middle table-primary">Approvals</td>
                    <td class="text-center align-middle">
                        {% set approvers = channel.approvals.all() %}                        
                        {% for approval in approvers %}
                            <button type="button" class="btn btn-outline-primary badge active" data-toggle="buttons">
                                {{ approval.user.username }}
                            </button>
                        {% endfor %}
                        <button type="button" class="btn btn-outline-primary badge" data-toggle="buttons">Supplier</button>                       
                        <button type="button" class="btn btn-outline-primary badge" data-toggle="buttons">Client</button>
                    </td>
                </tr>            
                <tr>
                    <td class="text-center align-middle table-primary">Notes</td>
                    <td class="text-center align-middle">
                        {{ channel_form.notes.data }}
                    </td>
                </tr>
            </tbody>
        </table>
    </td>
</tr>
